function closeOtherNotf(){jQuery("#populer_top_menu").stop();jQuery("#populer_top_menu").hide();jQuery("#following_top_menu").stop();jQuery("#following_top_menu").hide()}function checkNotifications(e){if(post_notifications_count){post_notifications_count.abort()}post_notifications_count=jQuery.ajax({type:"GET",url:TIMETY_PAGE_AJAX_GETNOTFCOUNT,data:{userId:e},success:function(e){if(e>0){var t=jQuery("#avtr_box_not");if(!t.length){t=jQuery('<div id="avtr_box_not" class="avtr_box">'+e+"</div>");var n=jQuery("#te_avatar");n.append(t)}else{t.text(e)}}else{t=jQuery("#avtr_box_not");t.remove()}}},"json");setTimeout(checkNotifications,5e3,e)}function closeNotifications(){jQuery("#li_notf_no_new_notf").remove();jQuery("#my_timety_notf_container").hide();jQuery("body").unbind("click.notfs",closeNotifications)}function showNotifications(e){jQuery("body").bind("click.notfs",closeNotifications);var t=jQuery("#my_timety_notf_container");var n=jQuery("#my_timety_notf");var r=jQuery("#my_timety_notf ul");if(!t.length){t=jQuery("<div>");t.attr("id","my_timety_notf_container");t.addClass("my_timety_notfication_container");t.attr("onclick","return false;");n=jQuery("<div>");n.attr("id","my_timety_notf");n.addClass("my_timete_popup");n.append(jQuery('<div class="kck_detay_ok" style="right:10px;"></div>'));r=jQuery("<ul>");r.attr("style","width:250px;");n.append(r);t.append(n);jQuery("body").append(t)}else{if(!r.length){r=jQuery("<ul>");n.append(r)}else{r.children().remove()}}r.css("margin-bottom","4px");n.css("right","75px");n.css("top","8px");n.css("min-width","204px");n.css("width","auto");n.css("position","absolute");t.show();var i=jQuery("<li>");i.css("text-align","center");i.append(jQuery('<img src="'+TIMETY_HOSTNAME+'images/ajax-loader.gif" style="height: 22px;">'));r.append(i);if(post_notifications){post_notifications.abort()}post_notifications=jQuery.ajax({type:"POST",url:TIMETY_PAGE_AJAX_GETNOTF,data:{userId:e},success:function(t){var n=jQuery.parseJSON(t);i.remove();if(n&&!n.error){for(var s=0;s<n.length;s++){var o=n[s];var u=jQuery("<li>");u.attr("id","li_notf_"+o.id);var a=o.title.length>30?o.title.substring(0,30):o.title;a=a+"...";u.append('<a style="color:#C2C2C2;float:left;" href="'+TIMETY_HOSTNAME+"event/"+o.id+'">'+a+"</a>");u.append("<span>    </span>");var f=jQuery('<a class="notf_answer_class" style="color:#C2C2C2;float:right;" href="#" onclick="var event = arguments[0] || window.event;return responseEvent(event,'+e+","+o.id+","+1+');">Yes | </a>');var l=jQuery('<a class="notf_answer_class" style="color:#C2C2C2;float:right;" href="#" onclick="var event = arguments[0] || window.event;return responseEvent(event,'+e+","+o.id+","+2+');">Maybe | </a>');var c=jQuery('<a class="notf_answer_class" style="color:#C2C2C2;float:right;" href="#" onclick="var event = arguments[0] || window.event;return responseEvent(event,'+e+","+o.id+","+3+');">Ignore</a>');u.append(c);u.append(l);u.append(f);r.append(u)}}else{u=jQuery("<li>");u.attr("id","li_notf_no_new_notf");a="No new notification";u.append('<a style="color:#C2C2C2;float:left;" href="#" onclick="return false;">'+a+"</a>");u.append("<span>    </span>");r.append(u)}}},"json")}function responseEvent(e,t,n,r){e.stopPropagation();if(t&&n&&r){var i=jQuery('<img src="'+TIMETY_HOSTNAME+'images/ajax-loader.gif" style="height: 22px;">');var s=jQuery("#li_notf_"+n);s.css("text-align","center");if(s.length){s.children().hide();s.append(i);jQuery.post(TIMETY_PAGE_AJAX_RESPONSETOEVENTINVITES,{e:n,u:t,r:r},function(e){i.remove();s.children(".notf_answer_class").remove();var t=jQuery("<span>");if(e.success){t.css("color","green");t.text("Success")}else{t.css("color","red");t.text("Error")}s.append(t);s.children().show()},"json")}else{jQuery("#my_timety_notf").hide();jQuery("body").unbind("click.notfs",closeNotifications)}}else{jQuery("#my_timety_notf").hide();jQuery("body").unbind("click.notfs",closeNotifications)}return false}var post_notifications=null;var post_notifications_count=null;var notf_click_check;jQuery(document).ready(function(){jQuery("#te_avatar").click(function(){jQuery.sessionphp.get("id",function(e){if(e){closeOtherNotf();showNotifications(e)}})});jQuery.sessionphp.get("id",function(e){if(e){setTimeout(checkNotifications,1e4,e)}})})