function compareCategory(e,t){if(e.label<t.label)return-1;else if(e.label>t.label)return 1;return 0}function closeOtherPoppular(){jQuery("#my_timety_notf_container").stop();jQuery("#my_timety_notf_container").hide();jQuery("#following_top_menu").stop();jQuery("#following_top_menu").hide()}function seacrhCategory(e){var t=jQuery("#populer_top_menu_search_input");var n=true;if(typeof e!="string"){e=t.val();if(e=="search"){e="*"}if(e==""){e="*"}}else{n=false}if(n)getLoader(true);if(n||jQuery("#populer_top_menu_search_ul").children().length<1){jQuery("#populer_top_menu_search_ul").children().remove();jQuery.sessionphp.get("id",function(t){if(t){jQuery.ajax({type:"GET",url:TIMETY_PAGE_AJAX_GETCATEGORY,data:{term:e},success:function(e){var r=jQuery.parseJSON(e);if(!r.error){r.sort(compareCategory);var i=jQuery("#populer_top_menu_search_ul");for(var s=0;s<r.length;s++){var o=r[s];var u=jQuery("#cat_id"+o.id);if(!u.length){var a=jQuery("<li>");a.attr("title",o.label);a.attr("id","cat_id"+o.id);var f=jQuery('<button type="button"></button>');f.addClass("ekle");f.addClass("icon_bg");f.data("userId",t);f.data("catId",o.id);f.data("catText",o.label);f.data("elementId","cat_id"+o.id);f.click(function(){subscribe(this)});var l=jQuery("<span>");var c=o.label;if(c.length>25){c=c.substr(0,25)}l.text(c);a.append(f);a.append(l);i.append(a)}}}else{}if(n)getLoader(false)}},"json")}})}}function openMyTimety(){jQuery("#populer_top_menu_a").css({"z-index":"2"});var e=jQuery("#populer_top_menu_ul");if(e.children().length<1){jQuery.sessionphp.get("id",function(e){if(e){jQuery.ajax({type:"GET",url:TIMETY_PAGE_AJAX_GETUSERCATSUBSCRIBES,data:{userId:e},success:function(t){var n=jQuery("#populer_top_menu_ul");var r=jQuery("<li>");var i=jQuery('<label class="label_check c_on" for="allcategories_"></label>');i.click(check_it);var s=jQuery('<input name="sample-check-01" id="allcategories_" value="1" type="checkbox">');s.click(checkAllCategories);var o=jQuery("<span>All Categories</span>");i.append(s);i.append(o);r.append(i);n.append(r);var u=jQuery.parseJSON(t);if(!u.error){u.sort(compareCategory);for(var a=0;a<u.length;a++){var f=u[a];var l=jQuery("<li>");l.attr("id","cat_id"+f.id);l.attr("title",f.name);var c=jQuery('<button type="button"></button>');c.addClass("kapat");c.addClass("icon_bg");c.data("userId",e);c.data("catId",f.id);c.data("elementId","cat_id"+f.id);c.data("catText",f.name);c.click(function(){unsubscribe(this)});var h=jQuery("<span>");var p=f.name;if(p.length>25){p=p.substr(0,25)}h.text(p);l.append(c);l.append(h);n.append(l)}}seacrhCategory("*")}},"json")}})}jQuery("#populer_top_menu").fadeIn(100)}function unsubscribe(e){e=jQuery(e);e.attr("disabled","disabled");userId=e.data("userId");catId=e.data("catId");catText=e.data("catText");elementId=e.data("elementId");element=jQuery("#"+elementId);element.attr("disabled","disabled");jQuery.ajax({type:"GET",url:TIMETY_PAGE_AJAX_UNSUBSCRIBEUSERCAT,data:{userId:userId,categoryId:catId},success:function(t){var n=jQuery.parseJSON(t);if(!n.error){jQuery(element).remove();var r=jQuery("#populer_top_menu_search_ul");var i=jQuery("<li>");i.attr("title",catText);i.attr("id",elementId);var s=jQuery('<button type="button"></button>');s.addClass("ekle");s.addClass("icon_bg");s.data("userId",userId);s.data("catId",catId);s.data("elementId",elementId);s.data("catText",catText);s.click(function(){subscribe(this)});var o=jQuery("<span>");var u=catText;if(u.length>25){u=u.substr(0,25)}o.text(u);i.append(s);i.append(o);var a=r.children();var f=false;for(var l=0;l<a.length;l++){var c=a.get(l);if(c&&c.title){if(c.title>catText){f=true;i.insertBefore(c);break}}}if(!f){r.append(i)}page_wookmark=0;wookmarkFiller(document.optionsWookmark,true,true)}e.removeAttr("disabled")}},"json")}function subscribe(e){var t=jQuery("#populer_top_menu_search_ul");e=jQuery(e);e.attr("disabled","disabled");userId=e.data("userId");catId=e.data("catId");catText=e.data("catText");elementId=e.data("elementId");element=jQuery("#"+elementId);element.attr("disabled","disabled");jQuery.ajax({type:"GET",url:TIMETY_PAGE_AJAX_SUBSCRIBEUSERCAT,data:{userId:userId,categoryId:catId},success:function(t){var n=jQuery.parseJSON(t);if(!n.error){jQuery(element).remove();var r=jQuery("#populer_top_menu_ul");var i=jQuery("<li>");i.attr("title",catText);i.attr("id",elementId);var s=jQuery('<button type="button"></button>');s.addClass("kapat");s.addClass("icon_bg");s.data("userId",userId);s.data("catId",catId);s.data("elementId",elementId);s.data("catText",catText);s.click(function(){unsubscribe(this)});var o=jQuery("<span>");var u=catText;if(u.length>25){u=u.substr(0,25)}o.text(u);i.append(s);i.append(o);var a=r.children();var f=false;for(var l=0;l<a.length;l++){var c=a.get(l);if(c&&c.title){if(c.title>catText){f=true;i.insertBefore(c);break}}}if(!f){r.append(i)}page_wookmark=0;wookmarkFiller(document.optionsWookmark,true,true)}e.removeAttr("disabled")}},"json")}function closeMyTimety(){jQuery("#populer_top_menu").hide();jQuery("#populer_top_menu_a").css({"z-index":"0"})}jQuery(document).ready(function(){jQuery("#top_menu_populer").hover(function(){closeOtherPoppular();openMyTimety()},function(){closeMyTimety()});jQuery("#populer_top_menu_search_button").click(seacrhCategory);jQuery("#populer_top_menu_search_input").keypress(function(e){if(e.keyCode==13){seacrhCategory()}})})