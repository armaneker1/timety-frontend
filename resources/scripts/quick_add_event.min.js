function showDateQA(e,t){if(e){jQuery("#te_quick_event_date").val(e);jQuery("#te_event_start_date").val(e)}if(t){jQuery("#quick_event_date_text").text(t);jQuery("#quick_event_date_text").show()}else{jQuery("#quick_event_date_text").hide()}}function showTimeQA(e,t){if(e){jQuery("#te_quick_event_time").val(e);jQuery("#te_event_start_time").val(e)}if(t){jQuery("#quick_event_time_text").text(t);jQuery("#quick_event_time_text").show()}else{jQuery("#quick_event_time_text").hide()}}function completeWord(e){if(e){var t=jQuery("#te_quick_event_desc").val();t=t.trim();var n=t.trim().split(" ");var r=n[n.length-1];t=t.substr(0,t.length-r.length)+e;jQuery("#te_quick_event_desc").val(t+" ")}}function setDateById(){var e=jQuery(this).attr("_id");var t=null;var n="";if(e=="1"||e==1){n="Today";t=moment().format("DD.MM.YYYY");showDateQA(t,n)}else if(e=="2"||e==2){n="Tomorrow";t=moment().add("days",1).format("DD.MM.YYYY");showDateQA(t,n)}jQuery("#quick_add_time_hint_model").hide()}function setCustomDate(){var e=date_string.substr(1);showDateQA(e,e);jQuery("#quick_add_time_hint_model").hide()}function setCustomTime(){var e=date_string.substr(1);showTimeQA(e,e);jQuery("#quick_add_time_hint_model").hide()}function empty(){alert("empty")}function getTimeHint(e){if(e&&e.length>2){var t=new Array;for(var n in date_var){n=n.toLowerCase();e=e.toLowerCase();if(n.indexOf(e)==0){t[t.length]=date_var[n]}}if(t.length>0){return t}else{if("@"==e.charAt(0)){try{e=e.substr(1);var r=moment(e,"DD.MM.YYYY");var i=moment(e,"DD/MM/YYYY");var s=moment(e,"HH:mm");var o=moment(e,"HH.mm");var u='{"id":"31","text":"';var a='","func":"';var f='"}';var l=true;if(r.isValid()){u=u+"@"+r.format("DD.MM.YYYY")+a+"setCustomDate"+f}else if(i.isValid()){u=u+"@"+i.format("DD.MM.YYYY")+a+"setCustomDate"+f}else if(s.isValid()){u=u+"@"+s.format("HH:mm")+a+"setCustomTime"+f}else if(o.isValid()){u=u+"@"+o.format("HH:mm")+a+"setCustomTime"+f}else{l=false}if(l){t[t.length]=u;return t}}catch(c){console.log(c)}}}}return false}function checkQuickEventInput(e){var t=jQuery("#quick_add_time_hint_model");var n=jQuery("#quick_add_time_hint_model_ul");var r=jQuery("#te_quick_event_desc").val();var i=false;if(r!=jQuery("#te_quick_event_desc").attr("placeholder")){var s=r.trim().split(" ");n.children().remove();if(s&&s.length>0){var o=s[s.length-1];var u=getTimeHint(o);if(u){i=true;var a=new Array;for(var f=0;f<u.length;f++){var l=u[f];try{if(typeof l=="string"){l=jQuery.parseJSON(l)}}catch(c){console.log(c)}if(!a[l.id]){a[l.id]=true;var h=createQuickAddHintLi(n,l.text,window[l.func]);h.attr("_id",l.id)}}}}}if(i){t.css("left",r.trim().length*6);t.show()}else{t.hide()}}function createQuickAddHintLi(e,t,n){var r='<li style="cursor:pointer;width: 100%;" title="'+t+'"><button type="button" class="ekle icon_bg"></button><span>'+t+"</span></li>";var i=jQuery(r);if(jQuery.isFunction(n)){i.click(function(){date_string=t;completeWord(t)});i.click(n)}e.append(i);return i}function createEvent(){var e=jQuery("#te_quick_event_desc").val();if(!e||jQuery("#te_quick_event_desc").attr("placeholder")==e){getInfo(true,"Description Field Empty","error",4e3);return}var t=jQuery("#te_quick_event_date").val();var n=jQuery("#te_quick_event_time").val();var r=jQuery("#te_quick_event_people_btn").data("people_array");var i="";for(var s=0;r&&s<r.length;s++){var o=r[s];if(o){if(i.length>0){i+=","}i+="u_"+o}}var u=jQuery("#te_quick_event_location").val();if(!u||jQuery("#te_quick_event_location").attr("placeholder")==u){u=""}var a=jQuery("#te_quick_event_loc_inpt").val();if(create_event_post==null){jQuery.sessionphp.get("id",function(r){var s=null;if(r)s=r;if(s){create_event_post=jQuery.ajax({type:"GET",url:TIMETY_PAGE_AJAX_CREATE_QUICK_EVENT,dataType:"json",contentType:"application/json",data:{event_description:e,event_start_date:t,event_start_time:n,event_peoples_list:i,event_loc:u,event_cor:a,userId:s},error:function(e,t,n){if(create_event_post){create_event_post.abort();create_event_post=null}getLoader(false);getInfo(true,"An erroroccured","error",4e3)},success:function(e){try{var t=null;try{if(typeof e=="string"){t=jQuery.parseJSON(e)}else{t=e}}catch(n){console.log(n);console.log(e)}if(!t||!t.success){console.log(t);getInfo(true,"An erroroccured","error",4e3);getLoader(false);return}else{getInfo(true,"Event created","info",4e3);getLoader(false);jQuery("#te_quick_add_event_bar").hide();return}}catch(r){getLoader(false);getInfo(true,r,"error",4e3);console.log(r);if(create_event_post){create_event_post.abort();create_event_post=null}getLoader(false)}finally{if(create_event_post){create_event_post.abort();create_event_post=null}getLoader(false)}}},"json")}})}}var date_string="";jQuery(document).ready(function(){jQuery("#te_quick_event_desc").keyup(function(e){if(e.which==13){if(jQuery("#quick_add_time_hint_model").is(":visible")){jQuery("#quick_add_time_hint_model_ul").children()[0].click();jQuery("#quick_add_time_hint_model").hide()}else{createEvent()}}else{checkQuickEventInput(e)}});jQuery("#te_quick_event_desc").keydown(function(e){if(e.which==8||e.which==46)setTimeout(function(){checkQuickEventInput(e)},30)});shortcut.add("down",function(){jQuery("#quick_add_time_hint_model_ul").select();jQuery("#quick_add_time_hint_model_ul").focus();return false},{target:jQuery("#te_quick_event_desc")[0]});shortcut.add("tab",function(){jQuery("#quick_add_time_hint_model_ul").select();jQuery("#quick_add_time_hint_model_ul").focus();return false},{target:jQuery("#te_quick_event_desc")[0]})});var create_event_post=null;var date_var={today:'{"id":"1","text":"Today","func":"setDateById"}',tomorrow:'{"id":"2","text":"Tomorrow","func":"setDateById"}',after:'{"id":"3","text":"Day After Tomorrow","func":"empty"}',month:'{"id":"4","text":"Next Month","func":"empty"}',week:'{"id":"5","text":"Next Week","func":"empty"}',january:'{"id":"7","text":"January","func":"empty"}',february:'{"id":"8","text":"February","func":"empty"}',march:'{"id":"9","text":"March","func":"empty"}',april:'{"id":"10","text":"April","func":"empty"}',may:'{"id":"11","text":"May","func":"empty"}',june:'{"id":"12","text":"June","func":"empty"}',july:'{"id":"13","text":"July","func":"empty"}',august:'{"id":"14","text":"August","func":"empty"}',september:'{"id":"15","text":"September","func":"empty"}',october:'{"id":"16","text":"October","func":"empty"}',november:'{"id":"17","text":"November","func":"empty"}',december:'{"id":"18","text":"December","func":"empty"}',tuesday:'{"id":"21","text":"Tuesday","func":"empty"}',wednesday:'{"id":"22","text":"Wednesday","func":"empty"}',thursday:'{"id":"23","text":"Thursday","func":"empty"}',friday:'{"id":"24","text":"Friday","func":"empty"}',monday:'{"id":"30","text":"Monday","func":"empty"}',saturday:'{"id":"25","text":"Saturday","func":"empty"}',sunday:'{"id":"26","text":"Sunday","func":"empty"}',year:'{"id":"29","text":"Next Year","func":"empty"}',"day after":'{"id":"3","text":"Day After Tomorrow","func":"empty"}',"next week":'{"id":"5","text":"Next Week","func":"empty"}',"next year":'{"id":"27","text":"Today","func":"empty"}',"next || monday":'{"id":"20","text":"Today","func":"empty"}',"%s weeks later":'{"id":"6","text":"DDDDDD6","func":"empty"}',"%s || january || %s":'{"id":"28","text":"DDDDDD6","func":"empty"}'}