var iPhoneStyle=function(e,t){t=Object.extend(Object.clone(iPhoneStyle.defaults),t||{});var n;if(Object.isString(e)){n=$$(e)}else{n=[e].flatten()}return n.each(function(e){if(!e){return}if(!e.match("input[type=checkbox]")){return}if(e.hasClassName(t.statusClass)){return}e.addClassName(t.statusClass);e.setOpacity(0);e.wrap("div",{"class":t.containerClass});e.insert({after:'<div class="'+t.handleClass+'"><div class="'+t.handleRightClass+'"><div class="'+t.handleCenterClass+'"></div></div></div>'}).insert({after:'<label class="'+t.labelOnClass+'"><span>'+t.checkedLabel+"</span></label>"}).insert({after:'<label class="'+t.labelOffClass+'"><span>'+t.uncheckedLabel+"</span></label>"});var n=e.up().down("."+t.handleClass),r=e.adjacent("."+t.labelOffClass).first(),i=r.down("span"),s=e.adjacent("."+t.labelOnClass).first(),o=s.down("span"),u=e.up();if(t.resizeHandle){var a=s.getWidth()<r.getWidth()?s.getWidth():r.getWidth();n.setStyle({width:a+"px"})}if(t.resizeContainer){var f=s.getWidth()>r.getWidth()?s.getWidth():r.getWidth();u.setStyle({width:f+n.getWidth()+12+"px"})}r.setStyle({width:u.getWidth()-5+"px"});var l=u.getWidth()-n.getWidth()-t.widthConstant;if(e.checked){n.setStyle({left:l+"px"});s.setStyle({width:l+4+"px"});i.setStyle({marginRight:l+"px"})}else{n.setStyle({left:0});s.setStyle({width:0});o.setStyle({marginLeft:-l+"px"})}e.change=function(){t.statusChange(e);var u=e.checked;var a=n.positionedOffset()[0]/l;new Effect.Tween(null,a,Number(u),{duration:t.duration/1e3},function(e){n.setStyle({left:e*l+"px"});s.setStyle({width:e*l+4+"px"});r.setStyle({width:(1-e)*l+4+"px"});i.setStyle({marginRight:-e*l+t.widthConstant2+"px"});o.setStyle({marginLeft:-(1-e)*l+t.widthConstant2+"px"})});t.statusChange(e)};e.observe("change",e.change);var c=function(e){e.stop();iPhoneStyle.clicking=n;var t=Event.pointerX(e)||e.changedTouches[0].pageX;iPhoneStyle.dragStartPosition=t-(Number(n.style.left.replace(/px$/,""))||0);Event.stop(e)};u.observe("mousedown",c);u.observe("touchstart",c);var h=function(e){if(iPhoneStyle.clicking==n){e.stop();var u=Event.pointerX(e)||e.changedTouches[0].pageX;if(u!=iPhoneStyle.dragStartPosition){iPhoneStyle.dragging=true}var a=(u-iPhoneStyle.dragStartPosition)/l;if(a<0){a=0}if(a>1){a=1}n.setStyle({left:a*l+"px"});s.setStyle({width:a*l+4+"px"});r.setStyle({width:(1-a)*l+4+"px"});i.setStyle({marginRight:-a*l+t.widthConstant2+"px"});o.setStyle({marginLeft:-(1-a)*l+t.widthConstant2+"px"})}};document.observe("mousemove",h);document.observe("touchmove",h);u.observe("mousedown",function(e){e.stop();iPhoneStyle.clicking=n;iPhoneStyle.dragStartPosition=Event.pointerX(e)-(Number(n.style.left.replace(/px$/,""))||0);return false});var p=function(t){if(iPhoneStyle.clicking==n){t.stop();if(!iPhoneStyle.dragging){var r=e.checked;e.writeAttribute("checked",!r)}else{var i=Event.pointerX(t)||t.changedTouches[0].pageX;var s=(i-iPhoneStyle.dragStartPosition)/l;e.writeAttribute("checked",s>=.5)}iPhoneStyle.clicking=null;iPhoneStyle.dragging=null;e.change()}};document.observe("touchend",p);document.observe("mouseup",p);[u,s,r,n].invoke("observe","mousedown",function(e){e.preventDefault();return false});if(Prototype.Browser.IE){[u,s,r,n].invoke("observe","startselect",function(e){Event.stop(e);return false})}})};iPhoneStyle.defaults={duration:200,checkedLabel:'<img src="images/pyes.png" width="14px" heght="10">',uncheckedLabel:'<img src="images/pno.png" width="9px" heght="10">',resizeHandle:true,resizeContainer:true,background:"#fff",statusClass:"checkRendered",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleCenterClass:"iPhoneCheckHandleCenter",handleRightClass:"iPhoneCheckHandleRight",widthConstant:3,widthConstant2:0,statusChange:function(){},beforeChange:function(){}}